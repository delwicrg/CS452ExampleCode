<html>
<head>
    <title>threejs - models</title>

    <style>
    	body{
    		margin: 0;
    		overflow: hidden;
    	}
    </style>
</head>
<body>

    <canvas id="myCanvas"></canvas>

    <script src="three.js"></script>
    <script src="GLTFLoader.js"></script>

    <script>

    var renderer,scene,camera,myCanvas = document.getElementById('myCanvas');

    //RENDERER
    renderer = new THREE.WebGLRenderer({
      canvas: myCanvas, 
      antialias: true
    });

    renderer.setClearColor(0x000000);
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(window.innerWidth, window.innerHeight);

    //CAMERA
    camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 0.1, 1000 );
    

    //SCENE
    scene = new THREE.Scene();

    camera.lookAt(scene.position); 

    //LIGHTS
    var light = new THREE.AmbientLight(0xffffff, 0.5);
    scene.add(light);

    var light2 = new THREE.PointLight(0xffffff, 0.5);
    scene.add(light2);

    const color = 0xFFFFFF;
    const intensity = 1;
    const light3 = new THREE.DirectionalLight(color, intensity);
    light3.position.set(0, 10, 0);
    light3.target.position.set(-5, 0, 0);
    scene.add(light3);
    scene.add(light3.target);

    //const controls = new OrbitControls(camera, renderer.domElement); //do we want to set this up?

    const loader = new THREE.GLTFLoader();


    var teapot;
    loader.load('teapot.glb',
    function(gltf){
        teapot = gltf.scene;

        gltf.scene.traverse(function(node){
        if(node.isMesh){
            node.castShadow = true;
            node.receiveShadow = true;
        }
        });
        scene.add(gltf.scene);
        teapot.position.z = -40.0;
    },
    function ( xhr ) {console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );},
        function ( error ) {console.log( 'An error happened' );}// called when loading has errors
    );


    var rightCup;
    loader.load('cup.glb',
    function(gltf){
        rightCup = gltf.scene;

        gltf.scene.traverse(function(node){
        if(node.isMesh){
            node.castShadow = true;
            node.receiveShadow = true;
        }
        });
        scene.add(gltf.scene);
        rightCup.scale.set(20, 20, 20);
        rightCup.position.z = -40;
        rightCup.position.y = 5;
        rightCup.position.x = 7;
    },
    function ( xhr ) { console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' ); },
        function ( error ) {console.log( 'An error happened' );} // called when loading has errors
    );

    var leftCup;
    loader.load('cup.glb',
    function(gltf){
        leftCup = gltf.scene;

        gltf.scene.traverse(function(node){
        if(node.isMesh){
            node.castShadow = true;
            node.receiveShadow = true;
        }
        });
        scene.add(gltf.scene);
        leftCup.scale.set(20, 20, 20);
        leftCup.position.z = -40;
        leftCup.position.y = 5;
        leftCup.position.x = -10;
    },
    function ( xhr ) { console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' ); },
        function ( error ) {console.log( 'An error happened' );} // called when loading has errors
    );


    var table;
    loader.load('table.glb',
    function(gltf){
        table = gltf.scene;

        gltf.scene.traverse(function(node){
        if(node.isMesh){
            node.castShadow = true;
            node.receiveShadow = true;
        }
        });
        scene.add(gltf.scene);
        table.scale.set(2.35, 2.35, 2.35);
        table.position.z = -40;
        //table.position.y = -5;
        //table.position.x = -10;
        table.rotation.x = 0.2;
        table.rotation.y = 0.5;
    },
    function ( xhr ) { console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' ); },
        function ( error ) {console.log( 'An error happened' );} // called when loading has errors
    );


    //RENDER LOOP
    render();

    var delta = 0;
    var prevTime = Date.now();

    function render() {
        delta += 0.1;

        if (teapot) {  
            teapot.rotation.y += 0.01;
        }
        if (rightCup) {  
            rightCup.rotation.y += 0.01;
        }
        if (leftCup) {  
            leftCup.rotation.y += 0.01;
        }

    	renderer.render(scene, camera);

    	requestAnimationFrame(render);
    }

    </script>
</body>
</html>
